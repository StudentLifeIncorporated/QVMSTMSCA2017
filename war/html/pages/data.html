<!DOCTYPE html>

<html lang="en-US">
<head>
	<title>Data Viewer | Dulles TMSCA Tournament</title>
	<meta name="description" content="View the Dulles High School TMSCA Tournament Data including registrations, users, requested clarifications, and scores">
	<meta name="robots" content="noindex, nofollow">
	<meta name="tab" content="ContestData">
	<meta name="type" content="$type">
	#include("head.html")
	<style type="text/css">
		body { padding-top: 60px; } /* 60px to make the container go all the way to the bottom of the topbar */
		.highlighted { background-color: #e8f8fd !important; }
		#if($registration)
			.container,
			.navbar-static-top .container,
			.navbar-fixed-top .container,
			.navbar-fixed-bottom .container { width: 1280px; }
			@media print { @page { size: landscape; } }
			.paidComments, .email {
				max-width: 90px;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}
			select { width: 90px; }
		#elseif($scores)
			@media print {
				.span2 * { visibility: hidden; }
				.span8 * { visibility: visible; }
				.span8 {
					position: absolute;
					left: 0;
					top: 0;
					width: 100% !important;
				}
				@page {	size: potrait; }
				h1 .btn { display: none; }
				#footer { visibility: hidden; }
			}
			h1 button { float: right; }
			table {	width: auto !important; }
			th, td { text-align: center !important; }
			.lead { margin-bottom: 0px !important; }
			a.anchor { 
				display: block; 
				position: relative; 
				top: -100px; 
				visibility: hidden;
			}
			#if($type.contains("school"))
				body { padding-top: 110px; }
			#end
		#elseif($questions)
			@media print { @page { size: landscape; } }
		#end
	</style>
	#if($scores)
	<link type="text/css" href="/css/footer.css" rel="stylesheet">
	<link type="text/css" href="/css/sticky-sidebar.css" rel="stylesheet">
	<link type="text/css" href="/css/sortedtable.css" rel="stylesheet">
	<link type="text/css" href="/css/font-awesome.min.css" rel="stylesheet">
	#end
</head>

<body>
	#if($scores)
	<div id="wrap">
		#parse("navbar.html")
		
		#if($type.contains("school"))
		<div class="navbar navbar-inverse navbar-fixed-top" style="margin-top: 50px !important;">
			<div class="navbar-inner">
				<div class="container">
					<div class="nav-collapse">
						<ul class="nav">
							<li><a href="#top20">"Top 20" Scores</a></li>
							<li><a href="#anonScores">"Anonymous" Scores</a></li>
							<li><a href="#visualizations">Visualizations</a></li>
							<li><a href="#sweepstakes">Current Sweepstakes</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		#end
		
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span2 offset1">
					<ul class="nav nav-list navbar-inverse sidebar-nav-fixed" #if($type.contains("school")) style="padding-top: 50px" #end>
						<li id="overview"><a href="/data?choice=scores">Overview</a></li>
						<li class="nav-header">Middle School</li>
						<li id="middle_students"><a href="/data?choice=scores&type=middle_students">All Students</a></li>
						<li id="middle_sweep"><a href="/data?choice=scores&type=middle_sweep">Sweepstakes</a></li>
						<li id="middle_categorySweep"><a href="/data?choice=scores&type=middle_categorySweep">Category Sweekstakes</a></li>
						<li id="middle_visualizations"><a href="/data?choice=scores&type=middle_visualizations">Visualizations</a></li>
						<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Schools<b
								class="caret"></b></a>
							<ul class="dropdown-menu">
								#foreach($school in $middleSchools)
								<li id="$school.getProperty("school").hashCode()"><a
									href="/data?choice=scores&type=middle_school_$esc.url($school.getProperty("school"))">$school.getProperty("school")</a></li>
								#end
							</ul></li>
						<li class="divider"></li>
	
						#foreach($num in [6..8])
						<li id="${num}" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">${num}th Grade<b
								class="caret"></b>
						</a>
							<ul class="dropdown-menu">
								<li id="middle_category_${num}C"><a href="/data?choice=scores&type=middle_category_${num}C">Calculator</a></li>
								<li id="middle_category_${num}N"><a href="/data?choice=scores&type=middle_category_${num}N">Number Sense</a></li>
								<li id="middle_category_${num}M"><a href="/data?choice=scores&type=middle_category_${num}M">Math</a></li>
								<li id="middle_category_${num}S"><a href="/data?choice=scores&type=middle_category_${num}S">Science</a></li>
							</ul></li>
						#end
	
						<li class="nav-header">High School</li>
						<li id="high_students"><a href="/data?choice=scores&type=high_students">All Students</a></li>
						<li id="high_sweep"><a href="/data?choice=scores&type=high_sweep">Sweepstakes</a></li>
						<li id="high_categorySweep"><a href="/data?choice=scores&type=high_categorySweep">Category Sweekstakes</a></li>
						<li id="high_visualizations"><a href="/data?choice=scores&type=high_visualizations">Visualizations</a></li>
						<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Schools<b
								class="caret"></b></a>
							<ul class="dropdown-menu">
								#foreach($school in $highSchools)
								<li id="$school.getProperty("school").hashCode()"><a
									href="/data?choice=scores&type=high_school_$esc.url($school.getProperty("school"))">$school.getProperty("school")</a></li>
								#end
							</ul></li>
						<li class="divider"></li>
		
						#foreach($num in [9..12])
						<li id="${num}" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">${num}th Grade<b
								class="caret"></b>
						</a>
							<ul class="dropdown-menu">
								<li id="high_category_${num}C"><a href="/data?choice=scores&type=high_category_${num}C">Calculator</a></li>
								<li id="high_category_${num}N"><a href="/data?choice=scores&type=high_category_${num}N">Number Sense</a></li>
								<li id="high_category_${num}M"><a href="/data?choice=scores&type=high_category_${num}M">Math</a></li>
								<li id="high_category_${num}S"><a href="/data?choice=scores&type=high_category_${num}S">Science</a></li>
							</ul></li>
						#end
					</ul>
				</div>
	
				<div class="span8">
					<h1>Contest Results
					<button class="btn btn-small">Print<i class="icon-print"></i></button>
					</h1>
					#if($overview) Choose an option at the left to view specific results. #elseif(!$html) Results for this
					competition are not yet available #else #evaluate($html) #end
					
					<div id="push"></div>
				</div>
			</div>
		</div>
	</div>
	
	<div id="footer">
      <div class="container">
        <p><i class="icon-time"></i> Last auto-generated <b>#if($date) $date #else never #end</b> | <a href="/contactUs">Contact Us</a> if you have any questions</p>
      </div>
    </div>
	#else
	#parse("navbar.html")
	<div class="container">
		<h1>Contest Data Viewer &amp; Editor</h1>
		
		#if($overview)
		<h2>Overview</h2>
		To view, edit, add, and modify registrations, go to the <a href="/data?choice=registrations">Registration
			Data Viewer &amp; Editor</a>. <br /> To view, delete, and respond to clarifications and questions sent through
		the <a href="/contactUs">Contact Us</a> page, go to the <a href="/data?choice=questions">Question Viewer</a>.
		<br /> To view student scores, go to the <a href="/data?choice=scores">Score Viewer</a>. <br /> 
		#elseif($registration) #if($updated)
		<div class="alert alert-success">
			<a class="close" data-dismiss="alert">&times;</a> <strong>Success! </strong>The changes have been committed
			to the database and are reflected below.
		</div>
		#end
		<h2>Recorded Registrations</h2>
		#set($middleTests = ["6n","6c","6m","6s","7n","7c","7m","7s","8n","8c","8m","8s"])
		#set($highTests = ["9n","9c","9m","9s","10n","10c","10m","10s","11n","11c","11m","11s","12n","12c","12m","12s"])
		<em>Note:</em> first number indicates number of registrations and second the number of tests actually taken
		<br/><strong>Click a cell to edit its registration</strong>
		<form method="get" class="form-horizontal" action="/editRegistration">
			<h3>Middle School</h3>
			<table class="table table-striped table-condensed table-hover" id="middleReg">
				<thead>
					<tr>
						<th>Edit</th>
						<th>Name</th>
						<th colspan="2">E-Mail</th>
						<th>Reg. Type</th>
						<th>School</th>
						<th>Aliases</th>
						<th>Payment</th>
						<th>Account</th>
						#foreach($test in $middleTests)
						<th colspan="2" style="text-align: center;">$test</th>
						#end
						<th>Cost</th>
					</tr>
				</thead>
				<tbody>
					#set($nums = [0,0,0,0,0,0,0,0,0,0,0,0,0]) 
					#foreach($reg in $middleRegs)
					<tr data-eid="$reg.getKey().getId()">
						<td class="uneditable" style="text-align: center;" title="$reg.getProperty("timestamp")"><input type="radio" name="key" value="$reg.getKey().getId()"></td>
						<td data-type="name">$reg.getProperty("name")</td>
						<td data-type="email" class="email" style="padding-right: 0px;">$reg.getProperty("email")</td>
						<td class="uneditable" style="padding-left: 0px;"><a href="mailto:$reg.getProperty("name")<$reg.getProperty("email")>"><i class="icon-envelope"></i></a></td>
						<td data-type="registrationType" class="regType uneditable">$reg.getProperty("registrationType")</td>
						<td data-type="schoolName">$reg.getProperty("schoolName")</td>
						
						#if($reg.getProperty("aliases")) <td data-type="aliases">$reg.getProperty("aliases")</td> #else	<td></td> #end
						
						<td data-type="paid" class="paidComments">$reg.getProperty("paid")</td> 
						<td class="account uneditable">$reg.getProperty("account")</td>
						
						#set($i = 0)
						#foreach($test in $middleTests)
						<td class="test" data-type="$test">$reg.getProperty($test)</td>
						<td class="uneditable">#if($reg.getProperty($test.toUpperCase()))$reg.getProperty($test.toUpperCase())#else 0#end</td>
						#set($nums[$i] = $nums[$i] + $reg.getProperty($test)) #set($i = $i + 1)
						#end
						
						<td class="uneditable">&#36;$reg.getProperty("cost")</td> 
						#set($nums[12] = $nums[12] + $reg.getProperty("cost"))
					</tr>
					#end 
					#set($nums[12] = "&#36;$nums[12]")
				</tbody>
				<tfoot> 
					<tr>
						<td></td>
						<td style="font-weight: bold;">Total</td>
						#foreach($i in [1..7]) <td></td> #end
						#foreach($i in [0..12])<td #if($i != 12) colspan="2" #end style="font-weight: bold;">$nums[$i]</td> #end
					</tr>
				</tfoot>
			</table>
	
			<h3>High School</h3>
			<table class="table table-striped table-condensed table-hover" id="highReg">
				<thead>
					<tr data-eid="$reg.getKey().getId()">
						<th>Edit</th>
						<th>Name</th>
						<th colspan="2">E-Mail</th>
						<th>Reg. Type</th>
						<th>School</th>
						<th>Aliases</th>
						<th>Payment</th>
						<th>Account</th>
						#foreach($test in $highTests)
						<th colspan="2" style="text-align: center;">$test</th>
						#end
						<th>Cost</th>
					</tr>
				</thead>
				<tbody>
					#set($nums = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]) 
					#foreach($reg in $highRegs)
					<tr data-eid="$reg.getKey().getId()">
						<td class="uneditable" style="text-align: center;" title="$reg.getProperty("timestamp")"><input type="radio" name="key" value="$reg.getKey().getId()"></td>
						<td data-type="name">$reg.getProperty("name")</td>
						<td data-type="email" class="email" style="padding-right: 0px;">$reg.getProperty("email")</td>
						<td class="uneditable" style="padding-left: 0px;"><a href="mailto:$reg.getProperty("name")<$reg.getProperty("email")>"><i class="icon-envelope"></i></a></td>
						<td data-type="registrationType" class="regType uneditable">$reg.getProperty("registrationType")</td>
						<td data-type="schoolName">$reg.getProperty("schoolName")</td>
						
						#if($reg.getProperty("aliases")) <td data-type="aliases">$reg.getProperty("aliases")</td> #else	<td></td> #end
						
						<td data-type="paid" class="paidComments">$reg.getProperty("paid")</td> 
						<td class="account uneditable">$reg.getProperty("account")</td>
						
						#set($i = 0)
						#foreach($test in $highTests)
						<td class="test" data-type="$test">$reg.getProperty($test)</td>
						<td class="uneditable">#if($reg.getProperty($test.toUpperCase()))$reg.getProperty($test.toUpperCase())#else 0#end</td>
						#set($nums[$i] = $nums[$i] + $reg.getProperty($test)) #set($i = $i + 1)
						#end
						
						<td class="uneditable">&#36;$reg.getProperty("cost")</td>
						#set($nums[16] = $nums[16] + $reg.getProperty("cost"))
					</tr>
					#end 
					#set($nums[16] = "&#36;$nums[16]")
				</tbody>
				<tfoot>
					<tr>
							<td></td>
							<td style="font-weight: bold;">Total</td>
							#foreach($i in [1..7]) <td></td> #end
							#foreach($i in [0..16])<td #if($i != 16) colspan="2" #end style="font-weight: bold;">$nums[$i]</td> #end
					</tr>
				</tfoot>
			</table>
		
			
			<button type="submit" id="submit" class="btn btn-primary"><i class="icon-edit"></i> Edit Selected</button>
			<strong>Individual registration editing interface</strong>
		</form>

		#elseif($questions) 
		#if($updated)
		<div class="alert alert-success">
			<a class="close" data-dismiss="alert">&times;</a> <strong>Success! </strong>The changes have been committed
			to the database and are reflected below.
		</div>
		#end

		<h2>Questions & Clarifications Requested</h2>
		<h3>Unresolved Questions</h3>
		<form method="post">
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th style="width: 5%">Resolved?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>School Name</th>
						<th>Message</th>
					</tr>
				</thead>
				<tbody>
					#foreach($q in $unresolvedQs)
					<tr>
						<td style="text-align: center"><input type="checkbox" name="$q.getKey().getId()" value="r"></td>
						<td>$q.getProperty("name")</td>
						<td><a href="mailto:$q.getProperty("email")">$q.getProperty("email")</a></td>
						<td>$q.getProperty("school")</td>
						<td>$q.getProperty("comment")</td>
					</tr>
					#end
				</tbody>
			</table>
			<h3>Resolved Questions</h3>
			<table class="table table-striped table-condensed table-hover">
				<thead>
					<tr>
						<th style="width: 5%">Delete?</th>
						<th>Name</th>
						<th>E-Mail</th>
						<th>School Name</th>
						<th>Message</th>
					</tr>
				</thead>
				<tbody>
					#foreach($q in $resolvedQs)
					<tr>
						<td style="text-align: center"><input type="checkbox" name="$q.getKey().getId()" value="d"></td>
						<td>$q.getProperty("name")</td>
						<td><a href="mailto:$q.getProperty("email")">$q.getProperty("email")</a></td>
						<td>$q.getProperty("school")</td>
						<td>$q.getProperty("comment")</td>
					</tr>
					#end
				</tbody>
			</table>
			<div class="form-actions">
				<button type="submit" id="submit" class="btn btn-primary"><i class="icon-pencil"></i> Apply Changes</button>
			</div>
		</form>
		#elseif($overview) hi #else #end #end
	</div>

	#if($scores)
		<script type="text/javascript" src="/js/pagescripts/data-scores.js"></script>
		<script type="text/javascript" src="/js/jquery/jquery.tablesorter.min.js"></script>
		#if($type.toLowerCase().endsWith("sweep"))
			<script type="text/javascript" src="/js/score-popovers.js"></script>
		#end
		#if($type.endsWith("visualizations") || $type.contains("school"))
			<script type="text/javascript" src="/js/highcharts/highcharts.js"></script>
			<script type="text/javascript" src="/js/highcharts/highcharts-more.js"></script>
			<script type="text/javascript" src="/js/highcharts/exporting.js"></script>
			<script type="text/javascript" src="/js/highcharts/theme.js"></script>
		#end
	#elseif($registration)
		<script type="text/javascript" src="/js/jquery/jquery.jeditable.mini.js"></script>
		<script type="text/javascript" src="/js/pagescripts/data-registrations.js"></script>
	#elseif($questions)
		<script type="text/javascript" src="/js/pagescripts/data-questions.js"></script>
	#end
	#include("noscript.html")
</body>
</html>